(this["webpackJsonpflixu-dao"]=this["webpackJsonpflixu-dao"]||[]).push([[5],{1018:function(e,t){},1020:function(e,t){},1032:function(e,t){},1048:function(e,t){},1050:function(e,t){},1052:function(e,t){},1192:function(e,t){},1194:function(e,t){},1201:function(e,t){},1202:function(e,t){},1218:function(e,t){},1220:function(e,t){},1228:function(e,t){},1239:function(e,t){},1308:function(e,t,n){"use strict";n.r(t);var s=n(0),r=n.n(s),c=n(277),a=n.n(c),i=(n(631),n(632),n(29)),o=n(11),u=n(33),l=n(1),d=n.n(l),j=(n(375),n(57)),b=n(122),p=n(68),x=n(6),f=function(){var e=Object(s.useState)(0),t=Object(u.a)(e,2),n=t[0],r=t[1],c=Object(s.useState)(0),a=Object(u.a)(c,2),i=a[0],l=a[1],f=Object(s.useState)(0),O=Object(u.a)(f,2),h=O[0],v=O[1],m=Object(s.useState)(0),g=Object(u.a)(m,2),y=g[0],w=g[1],N=Object(p.b)(),P=N.Moralis,S=N.isInitialized,k=Object(s.useState)(),F=Object(u.a)(k,2),T=F[0],C=F[1],D=Object(p.c)(),I=Object(s.useState)(),E=Object(u.a)(I,2),z=E[0],V=E[1],_=Object(p.e)(),A=Object(j.j)(),L=function(e,t,n){A({type:e,message:"Only token holders can create proposals",title:"Note:",icon:t,position:n||"topR"})};function R(){return(R=Object(o.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={contractAddress:"0x4d11ff4250D4b12Aa508d99E6fCa6700354E4271",functionName:"createProposal",abi:[{inputs:[{internalType:"string",name:"_description",type:"string"},{internalType:"address[]",name:"_canVote",type:"address[]"}],name:"createProposal",outputs:[],stateMutability:"nonpayable",type:"function"}],params:{_description:t,_canVote:y}},e.next=3,_.fetch({params:n,onSuccess:function(){console.log("Proposal Succesful"),V(!1)},onError:function(e){L("warning"),V(!1)}});case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e){return Y.apply(this,arguments)}function Y(){return(Y=Object(o.a)(d.a.mark((function e(t){var n,s,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=P.Object.extend("ProposalCountslFlixu"),(s=new P.Query(n)).equalTo("uid",t),e.next=5,s.first();case 5:if(void 0===(r=e.sent)){e.next=14;break}if(!r.attributes.passed){e.next=11;break}return e.abrupt("return",{color:"green",text:"Passed"});case 11:return e.abrupt("return",{color:"IndianRed",text:"Rejected"});case 12:e.next=15;break;case 14:return e.abrupt("return",{color:"blue",text:"In progress"});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){if(S){var e=function(){var e=Object(o.a)(d.a.mark((function e(){var t,n,s,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=P.Object.extend("ProposalFixu"),(n=new P.Query(t)).descending("uid_decimal"),e.next=5,n.find();case 5:return s=e.sent,e.next=8,Promise.all(s.map(function(){var e=Object(o.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t.attributes.uid,e.t1=t.attributes.description,e.t2=x.jsx,e.t3=b.b,e.t4=t.attributes.description,e.next=7,U(t.attributes.uid);case 7:return e.t5=e.sent.color,e.next=10,U(t.attributes.uid);case 10:return e.t6=e.sent.text,e.t7=t.attributes.uid,e.t8=t.attributes.proposer,e.t9={description:e.t4,color:e.t5,text:e.t6,id:e.t7,proposer:e.t8},e.t10=x.jsx,e.t11=j.g,e.next=18,U(t.attributes.uid);case 18:return e.t12=e.sent.color,e.next=21,U(t.attributes.uid);case 21:return e.t13=e.sent.text,e.t14={color:e.t12,text:e.t13},e.t15=(0,e.t10)(e.t11,e.t14),e.t16={to:"/proposal",state:e.t9,children:e.t15},e.t17=(0,e.t2)(e.t3,e.t16),e.abrupt("return",[e.t0,e.t1,e.t17]);case 27:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 8:r=e.sent,C(r),l(s.length);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t=function(){var e=Object(o.a)(d.a.mark((function e(){var t,n,s,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=P.Object.extend("ProposalCountsFixu"),n=new P.Query(t),e.next=4,n.find();case 4:s=e.sent,c=0,s.forEach((function(e){e.attributes.passed&&c++})),v(s.length),r(c/s.length*100);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n=function(){var e=Object(o.a)(d.a.mark((function e(){var t,n,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={address:"0x88B48F654c30e99bc2e4A1559b4Dcf1aD93FA656",token_id:"41614406511745041653207711197477315887447207143736222868571693913704398586856",chain:"rinkeby"},e.next=3,D.token.getTokenIdOwners(t);case 3:n=e.sent,s=n.result.map((function(e){return e.owner_of})),w(s);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();n(),e(),t()}}),[S]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"content",children:[Object(x.jsx)("div",{className:"headerNote",children:"FLIXU DAO"}),Object(x.jsx)("div",{children:"\xa0"}),T&&Object(x.jsxs)("div",{className:"tabContent",children:[Object(x.jsxs)("div",{className:"widgets",children:[Object(x.jsx)(j.i,{info:i,title:"Proposals",style:{width:"200%"},children:Object(x.jsxs)("div",{className:"extraWidgetInfo",children:[Object(x.jsx)("div",{className:"extraTitle",children:"Passed"}),Object(x.jsx)("div",{className:"progress",children:Object(x.jsx)("div",{className:"progressPercentage",style:{width:"".concat(n,"%")}})})]})}),Object(x.jsx)(j.i,{info:y.length,title:"Authorized Voters"}),Object(x.jsx)(j.i,{info:i-h,title:"Proposals In progress"})]}),"Proposals",Object(x.jsx)("div",{style:{marginTop:"30px"},children:Object(x.jsx)(j.f,{columnsConfig:"10% 70% 20%",data:T,header:[Object(x.jsx)("span",{children:"#"}),Object(x.jsx)("span",{children:"Topic"}),Object(x.jsx)("span",{children:"Status"})],pageSize:5})}),Object(x.jsx)("div",{children:"New Proposal"}),Object(x.jsx)("div",{children:"\xa0"}),Object(x.jsx)(j.c,{buttonConfig:{color:"blue",isLoading:z,iconLayout:"trailing",icon:"plus",loadingText:"Post Proposal",theme:"colored"},data:[{inputWidth:"100%",name:"Add Proposal",type:"textarea",validation:{required:!0},value:""}],onSubmit:function(e){V(!0),function(e){R.apply(this,arguments)}(e.data[0].inputResult)}}),Object(x.jsx)("div",{children:"\xa0"})]})]}),Object(x.jsx)("div",{className:"voting"}),Object(x.jsx)("div",{children:"\xa0"})]})},O=(n(276),function(){var e=Object(i.e)().state,t=Object(p.b)(),n=t.Moralis,r=t.isInitialized,c=Object(s.useState)(),a=Object(u.a)(c,2),l=a[0],f=a[1],O=Object(s.useState)(0),h=Object(u.a)(O,2),v=h[0],m=h[1],g=Object(s.useState)(0),y=Object(u.a)(g,2),w=y[0],N=y[1],P=Object(s.useState)([]),S=Object(u.a)(P,2),k=S[0],F=S[1],T=Object(s.useState)(!1),C=Object(u.a)(T,2),D=C[0],I=C[1],E=Object(p.e)(),z=Object(j.j)(),V=function(e,t,n){z({type:e,message:"You can not vote on this Proposal",title:"Note:",icon:t,position:n||"topR"})};function _(e){return A.apply(this,arguments)}function A(){return(A=Object(o.a)(d.a.mark((function t(n){var s;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s={contractAddress:"0x4d11ff4250D4b12Aa508d99E6fCa6700354E4271",functionName:"voteOnProposal",abi:[{inputs:[{internalType:"uint256",name:"_id",type:"uint256"},{internalType:"bool",name:"_vote",type:"bool"}],name:"voteOnProposal",outputs:[],stateMutability:"nonpayable",type:"function"}],params:{_id:e.id,_vote:n}},t.next=3,E.fetch({params:s,onSuccess:function(){console.log("Vote Cast Succesfully"),I(!1)},onError:function(e){V("warning"),alert(e.data.message),I(!1)}});case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(s.useEffect)((function(){if(r){var t=function(){var t=Object(o.a)(d.a.mark((function t(){var s,r,c,a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=n.Object.extend("VotesFlixu"),(r=new n.Query(s)).equalTo("proposal",e.id),r.descending("createdAt"),t.next=6,r.find();case 6:(c=t.sent).length>0&&(f(c[0].attributes),N((Number(c[0].attributes.votesDown)/(Number(c[0].attributes.votesDown)+Number(c[0].attributes.votesUp))*100).toFixed(0)),m((Number(c[0].attributes.votesUp)/(Number(c[0].attributes.votesDown)+Number(c[0].attributes.votesUp))*100).toFixed(0))),a=c.map((function(e){return[e.attributes.voter,Object(x.jsx)(j.d,{fill:e.attributes.votedFor?"#2cc40a":"#d93d3d",size:24,svg:e.attributes.votedFor?"checkmark":"arrowCircleDown"})]})),F(a);case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}}),[r]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"contentProposal",children:[Object(x.jsxs)("div",{className:"proposal",children:[Object(x.jsx)(b.b,{to:"/",children:Object(x.jsxs)("div",{className:"backHome",children:[Object(x.jsx)(j.d,{fill:"#ffffff",size:20,svg:"chevronLeft"}),"Home"]})}),Object(x.jsx)("div",{children:e.description}),Object(x.jsxs)("div",{className:"proposalOverview",children:[Object(x.jsx)(j.g,{color:e.color,text:e.text}),Object(x.jsxs)("div",{className:"proposer",children:[Object(x.jsx)("span",{children:"Proposer "}),Object(x.jsx)("span",{}),Object(x.jsx)(j.h,{content:e.proposer,children:Object(x.jsx)(j.a,{seed:e.proposer})})]})]})]}),l&&Object(x.jsxs)("div",{className:"widgets",children:[Object(x.jsx)(j.i,{info:l.votesUp,title:"Votes Yes",children:Object(x.jsxs)("div",{className:"extraWidgetInfo",children:[Object(x.jsxs)("div",{className:"extraTitle",children:[v,"%"]}),Object(x.jsx)("div",{className:"progress",children:Object(x.jsx)("div",{className:"progressPercentage",style:{width:"".concat(v,"%")}})})]})}),Object(x.jsx)(j.i,{info:l.votesDown,title:"Votes No.",children:Object(x.jsxs)("div",{className:"extraWidgetInfo",children:[Object(x.jsxs)("div",{className:"extraTitle",children:[w,"%"]}),Object(x.jsx)("div",{className:"progress",children:Object(x.jsx)("div",{className:"progressPercentage",style:{width:"".concat(w,"%")}})})]})})]}),Object(x.jsxs)("div",{className:"votesDiv",children:[Object(x.jsx)(j.f,{style:{width:"60%"},columnsConfig:"90% 10%",data:k,header:[Object(x.jsx)("span",{children:"Wallet"}),Object(x.jsx)("span",{children:"Vote"})],pageSize:5}),Object(x.jsx)(j.c,{isDisabled:"In progress"!==e.text,style:{width:"35%",height:"250px",border:"1px solid rgba(6, 158, 252, 0.2)"},buttonConfig:{color:"blue",isLoading:D,loadingText:"Your vote",text:"Your vote",theme:"colored"},data:[{inputWidth:"100%",name:"Vote",options:["Yes","No"],type:"radios",validation:{required:!0}}],onSubmit:function(e){"Yes"===e.data[0].inputResult[0]?_(!0):_(!1),I(!0)},title:"Your vote"})]})]}),Object(x.jsx)("div",{className:"voting"})]})}),h=n.p+"static/media/YourLogo.61f2818a.png",v=function(){return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"header",children:[Object(x.jsx)("img",{src:h,alt:"logo",width:"72px",height:"70px"}),Object(x.jsx)(j.b,{signingMessage:"Flixu Dao Hello."})]}),Object(x.jsxs)(i.c,{children:[Object(x.jsx)(i.a,{path:"/",element:Object(x.jsx)(f,{})}),Object(x.jsx)(i.a,{path:"/proposal",element:Object(x.jsx)(O,{})})]}),Object(x.jsx)("div",{children:"\xa0"})]})},m=function(e){e&&e instanceof Function&&n.e(18).then(n.bind(null,1530)).then((function(t){var n=t.getCLS,s=t.getFID,r=t.getFCP,c=t.getLCP,a=t.getTTFB;n(e),s(e),r(e),c(e),a(e)}))};a.a.render(Object(x.jsx)(r.a.StrictMode,{children:Object(x.jsx)(p.a,{appId:"zZO9lElSUBezWVjfCxmQrdsuU2OezsRZ2VRw3FE5",serverUrl:"https://udnjdcrnz145.usemoralis.com:2053/server",children:Object(x.jsx)(b.a,{children:Object(x.jsx)(j.e,{children:Object(x.jsx)(v,{})})})})}),document.getElementById("root")),m()},375:function(e,t,n){},631:function(e,t,n){},632:function(e,t,n){},926:function(e,t){},956:function(e,t){},996:function(e,t){},998:function(e,t){}},[[1308,6,7]]]);
//# sourceMappingURL=main.001673e5.chunk.js.map